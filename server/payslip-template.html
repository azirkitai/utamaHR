<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Payslip Template (HQ Layout)</title>
  <style>
    /* ===== PAGE & BASE - VERY SMALL SIZE (120mm x 170mm) ===== */
    @page { 
      size: 120mm 170mm; /* Much smaller than A4 */
      margin: 3mm; 
    }
    html, body { margin: 0; padding: 0; }
    body { 
      font-family: Inter, Roboto, Arial, sans-serif; 
      color:#111827; 
      font-size:8px; /* Smaller font for compact size */
      -webkit-print-color-adjust: exact; 
      print-color-adjust: exact; 
      padding: 2mm; 
      margin: 0;
      max-width: 114mm; /* Fit within smaller page */
    }
    .muted { color:#6B7280; }
    .small { font-size: 7px; }
    .bold { font-weight:700; }
    .right { text-align:right; }
    .mb-6 { margin-bottom: 4px; }
    .mb-4 { margin-bottom: 3px; }
    .mb-3 { margin-bottom: 2px; }
    .mb-2 { margin-bottom: 1px; }
    .mt-2 { margin-top: 1px; }

    /* ===== HEADER - COMPACT FOR SMALL SIZE ===== */
    .confidential { font-size:7px; text-transform:uppercase; float:right; margin-bottom: 2px; }
    .header-container { display: flex; align-items: flex-start; gap: 5px; margin-bottom: 3px; }
    .company-logo { width: 35px; height: 35px; object-fit: contain; }
    .company-info { flex: 1; }
    .company-name { font-weight:700; font-size:9px; margin-bottom: 0.5px; }
    .company-reg { font-size:7px; margin-bottom: 0.5px; }
    .company-addr { font-size:7px; line-height: 1.1; margin-bottom: 3px; }

    /* ===== PANELS & TABLES - VERY COMPACT ===== */
    .panel { border:1px solid #E5E7EB; border-radius:2px; padding:2px; }
    .row { display:flex; gap:4px; }
    .col { flex:1; }

    .kv { display:flex; gap:2px; margin: 0.5px 0; }
    .kv .k { width: 45px; color:#6B7280; font-size:7px; }
    .kv .v { flex: 1; font-weight:600; font-size:7px; }

    .twocol { display:grid; grid-template-columns: 1fr 1fr; gap:4px; }
    .tbl { border:1px solid #E5E7EB; border-radius:3px; overflow: hidden; }
    .tbl .hd { background:#F9FAFB; padding:2px 4px; font-weight:700; border-bottom:1px solid #E5E7EB; font-size:7px; }
    .tbl .rowi { display:flex; justify-content:space-between; align-items:center; padding:1px 4px; font-size:7px; }
    .tbl .sep { border-top:1px solid #E5E7EB; margin-top:1px; padding-top:1px; font-weight:700; }
    .money { text-align:right; min-width: 40px; }

    .net { margin-top:2px; padding:3px; border:1px solid #E5E7EB; border-radius:2px; font-weight:800; font-size:8px; display:flex; justify-content:space-between; }

    .grid3 { display:grid; grid-template-columns: 1fr 1fr 1fr; gap:3px; }
    .section-title { color:#6B7280; font-weight:700; margin:2px 0 1px; font-size:7px; }
    .hr { border-top:1px solid #E5E7EB; margin:2px 0; }

    /* Print friendly adjustments - 3/4 A4 optimized */
    @media print {
      .no-print { display:none !important; }
      body { 
        -webkit-print-color-adjust: exact; 
        margin: 0 !important; 
        padding: 1mm !important;
        transform: scale(0.75) !important; 
        transform-origin: top left !important;
        width: 133.33% !important;
        height: 133.33% !important;
      }
      @page { margin: 1mm !important; }
      * { box-sizing: border-box; }
      .container { max-width: 100% !important; overflow: hidden !important; }
    }
  </style>
</head>
<body>

  <!-- ===== HEADER (follow HQ layout) ===== -->
  <div class="confidential">STRICTLY PRIVATE &amp; CONFIDENTIAL</div>
  <div class="header-container">
    {{company.logoHTML}}
    <div class="company-info">
      <div class="company-name">{{company.name}}</div>
      <div class="company-reg">{{company.regNo}}</div>
      <div class="company-addr">{{company.address}}</div>
    </div>
  </div>

  <!-- ===== EMPLOYEE / PERIOD PANEL ===== -->
  <div class="panel mb-4 mt-2">
    <div class="row">
      <div class="col">
        <div class="kv"><div class="k">NAME:</div><div class="v">{{employee.name}}</div></div>
        <div class="kv"><div class="k">I/C NO.:</div><div class="v">{{employee.icNo}}</div></div>
        <div class="kv"><div class="k">POSITION:</div><div class="v">{{employee.position}}</div></div>
      </div>
      <div class="col">
        <div class="kv"><div class="k">MONTH:</div><div class="v">{{period.month}}</div></div>
        <div class="kv"><div class="k">YEAR:</div><div class="v">{{period.year}}</div></div>
      </div>
    </div>
  </div>

  <!-- ===== INCOME vs DEDUCTIONS ===== -->
  <div class="twocol">
    <!-- INCOME -->
    <div class="tbl">
      <div class="hd">INCOME</div>
      
      <!-- Dynamic income items (includes Basic Salary if > 0) -->
      {{incomeItems}}

      <div class="rowi sep"><div>TOTAL GROSS INCOME</div><div class="money">RM {{income.totalGross}}</div></div>
    </div>

    <!-- DEDUCTIONS -->
    <div class="tbl">
      <div class="hd">DEDUCTIONS</div>
      <div class="rowi"><div>EPF</div><div class="money">RM {{deduction.epfEmp}}</div></div>
      <div class="rowi"><div>SOCSO</div><div class="money">RM {{deduction.socsoEmp}}</div></div>
      <div class="rowi"><div>EIS</div><div class="money">RM {{deduction.eisEmp}}</div></div>

      <!-- Optional extra deduction rows (render only if > 0) -->
      {{deductionItems}}

      <div class="rowi sep"><div>TOTAL DEDUCTIONS</div><div class="money">RM {{deduction.total}}</div></div>
    </div>
  </div>

  <!-- NET INCOME -->
  <div class="net" style="background: #e9ecef; border-color: #6c757d;">
    <div>NET PAY</div>
    <div class="money">RM {{netIncome}}</div>
  </div>

  <!-- EMPLOYER CONTRIBUTION -->
  <div class="section-title">CURRENT MONTH EMPLOYER CONTRIBUTION</div>
  <div class="grid3">
    <div class="panel"><div>EPF</div><div class="money">RM {{employerContrib.epfEr}}</div></div>
    <div class="panel"><div>SOCSO</div><div class="money">RM {{employerContrib.socsoEr}}</div></div>
    <div class="panel"><div>EIS</div><div class="money">RM {{employerContrib.eisEr}}</div></div>
  </div>

  <div class="hr"></div>
  
  <!-- YTD SUMMARY BREAKDOWN -->
  <div class="section-title">YEAR TO DATE (YTD) BREAKDOWN</div>
  <div class="twocol">
    <div class="tbl">
      <div class="hd">EMPLOYEE CONTRIBUTION (YTD)</div>
      <div class="rowi"><div>EPF</div><div class="money">RM {{ytd.breakdown.epfEmployee}}</div></div>
      <div class="rowi"><div>SOCSO</div><div class="money">RM {{ytd.breakdown.socsoEmployee}}</div></div>
      <div class="rowi"><div>EIS</div><div class="money">RM {{ytd.breakdown.eisEmployee}}</div></div>
      <div class="rowi"><div>PCB/MTD</div><div class="money">RM {{ytd.breakdown.pcb}}</div></div>
      <div class="rowi sep"><div>TOTAL (YTD)</div><div class="money">RM {{ytd.employee}}</div></div>
    </div>
    
    <div class="tbl">
      <div class="hd">EMPLOYER CONTRIBUTION (YTD)</div>
      <div class="rowi"><div>EPF</div><div class="money">RM {{ytd.breakdown.epfEmployer}}</div></div>
      <div class="rowi"><div>SOCSO</div><div class="money">RM {{ytd.breakdown.socsoEmployer}}</div></div>
      <div class="rowi"><div>EIS</div><div class="money">RM {{ytd.breakdown.eisEmployer}}</div></div>
      <div class="rowi"><div>HRDF</div><div class="money">RM {{ytd.breakdown.hrdfEmployer}}</div></div>
      <div class="rowi sep"><div>TOTAL (YTD)</div><div class="money">RM {{ytd.employer}}</div></div>
    </div>
  </div>
  
  <div class="mt-2">
    <div class="panel">
      <div><b>CURRENT MONTH NET PAY: RM {{ytd.mtd}}</b></div>
    </div>
  </div>

</body>
</html>